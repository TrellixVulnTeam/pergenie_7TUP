{% extends "layout.html" %}
{% load i18n %}
{% load extras %}}
{% load staticfiles %}
{% block title %}{{ rs }}{% endblock %}
{% block description %}library of SNPs{% endblock %}

{% block main_container %}
<div id="main_container" class="span12">
  <section id="main">

    <div class="row-fluid">
      <div class="span12">
        <div class="content-box transparent">
          <div class="padded10">
            <h4>rs{{ rs }}</h4>
          </div>
        </div>
      </div>
    </div>

    <div class="row-fluid">
      <div class="span12">
        <div class="content-box">
          <div class="padded">

            <span class="badge badge-yellow" title="Go to the OMIM website"><a href="////omim.org/allelicVariant/{{ mimNumber }}" target="_blank">OMIM</a></span>

            {{ catalog_record }}

            {{ err }}
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>rs</th>
                  <th>chrom</th>
                  <th>position</th>
                  <th>ref</th>
                  <th>alt</th>
                  <th>context</th>
                  {% for file_name, variant in variants.items %}
                  <th>{{ file_name }}</th>
                  {% endfor %}
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td>{{ rs }}</td>
                  <td>{{ catalog_record.chr_id }}</td>
                  <td>{{ catalog_record.chr_pos }}</td>
                  <td>{{ catalog_record.ref }}</td>
                  <td>{{ catalog_record.risk_allele }}</td>
                  <td>{{ catalog_record.context }}</td>
                  {% for file_name, variant in variants.items %}
                  <td>{{ variant }}</td>
                  {% endfor %}
                </tr>
              </tbody>
            </table>
            <div id="container" style="min-width: 150px; height: 150px; margin: 0 auto"></div>

            {{ catalog_record.allele1 }}
            {{ catalog_record.allele1_freq }}
            {{ catalog_record.allele2 }}
            {{ catalog_record.allele2_freq }}

          </div>
        </div>
      </div>
    </div>
  </section>
</div>
{% endblock %}

{% block js %}
<script type="text/javascript">
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false
            },
            title: {
                text: 'allele frequency'
            },
            tooltip: {
                formatter: function() {
                    return '<b>'+ this.point.name +'</b>: '+ this.percentage +' %';
                }
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: true,
                        color: '#000000',
                        connectorColor: '#000000',
                        formatter: function() {
                            return '<b>'+ this.point.name +'</b>: '+ this.percentage +' %';
                        }
                    }
                }
            },
            credits: {
                enabled: false
            },
            series: [{
                type: 'pie',
                name: 'allele frequency',
                data: [
                      [ "{{ catalog_record.allele1 }}",   {{ catalog_record.allele1_freq }} ],
                      [ "{{ catalog_record.allele2 }}",   {{ catalog_record.allele2_freq }} ]
                ]
            }]
        });
    });

});
</script>


<script type="text/javascript" src="{% static 'js/highcharts/highcharts.js' %}"></script>
<script type="text/javascript" src="{% static 'js/highcharts/modules/exporting.js' %}"></script>


<script type="text/javascript">
$(document).ready(function(){
  $('#library_record_table').dataTable({
   "bJQueryUI": true,
   "bPaginate": false,
   "bLengthChange": false,
   "bFilter": true,
   "bAutoWidth": false,
   "oLanguage": {
            "sLengthMenu": "Display _MENU_ records per page",
            "sZeroRecords": "Nothing found - sorry",
            "sInfo": "Showing _TOTAL_ records",
            "sInfoEmpty": "Showing 0 record",
            "sInfoFiltered": "(filtered from _MAX_ total records)"
   },
   "sDom": '<"top"if>t<"bottom"lp><"clear">'
  });
});
</script>

{% endblock %}
